
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>C++ Reference &#8212; LoRANN 0.4.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=ff822928"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cpp';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python Reference" href="python.html" />
    <link rel="prev" title="LoRANN documentation" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">LoRANN 0.4.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    C++ Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="python.html">
    Python Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    C++ Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="python.html">
    Python Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">C++ Reference</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="c-reference">
<h1>C++ Reference<a class="headerlink" href="#c-reference" title="Link to this heading">#</a></h1>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I000EN6Lorann6LorannE">
<span id="_CPPv3I000EN6Lorann6LorannE"></span><span id="_CPPv2I000EN6Lorann6LorannE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataQuantizer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">SQ8Quantizer</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">QueryQuantizer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">SQ8Quantizer</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classLorann_1_1Lorann"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Lorann</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann"><span class="n"><span class="pre">Lorann</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">LorannBase</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I000EN6Lorann6LorannE" title="Link to this definition">#</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann6Lorann6LorannEP1Tiiiiii8Distancebb">
<span id="_CPPv3N6Lorann6Lorann6LorannEP1Tiiiiii8Distancebb"></span><span id="_CPPv2N6Lorann6Lorann6LorannEP1Tiiiiii8Distancebb"></span><span id="Lorann::Lorann::Lorann__TP.i.i.i.i.i.i.Distance.b.b"></span><span class="target" id="classLorann_1_1Lorann_1aba7818f78bd584d0275bc9ed26f0e1a9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Lorann</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_clusters</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">global_dim</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rank</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">train_size</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5</span></span>, <span class="n"><span class="pre">Distance</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">distance</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">IP</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">balanced</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">copy</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann6Lorann6LorannEP1Tiiiiii8Distancebb" title="Link to this definition">#</a><br /></dt>
<dd><p>Construct a new <a class="reference internal" href="#classLorann_1_1Lorann"><span class="std std-ref">Lorann</span></a> object. </p>
<p>NOTE: The constructor does not build the actual index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The data matrix as a T array of size <span class="math notranslate nohighlight">\(m \times d\)</span>, where T is either float, simsimd_f16_t, simsimd_bf16_t, uint8_t, or Lorann::BinaryType </p></li>
<li><p><strong>m</strong> – Number of points (rows) in the data matrix </p></li>
<li><p><strong>d</strong> – Number of dimensions (cols) in the data matrix </p></li>
<li><p><strong>n_clusters</strong> – Number of clusters. In general, for <span class="math notranslate nohighlight">\(m\)</span> index points, a good starting point is to set n_clusters as around <span class="math notranslate nohighlight">\(\sqrt{m}\)</span>. </p></li>
<li><p><strong>global_dim</strong> – Globally reduced dimension (<span class="math notranslate nohighlight">\(s\)</span>). Must be either -1 or an integer that is a multiple of 32. If global_dim = -1, no dimensionality reduction is used, but the original dimensionality must be a multiple of 32 in this case. Higher values increase recall but also increase the query latency. In general, a good starting point is to set global_dim = -1 if <span class="math notranslate nohighlight">\(d &lt; 200\)</span>, global_dim = 128 if <span class="math notranslate nohighlight">\(200 \leq d \leq 1000\)</span>, and global_dim = 256 if <span class="math notranslate nohighlight">\(d &gt; 1000\)</span>. </p></li>
<li><p><strong>rank</strong> – Rank (<span class="math notranslate nohighlight">\(r\)</span>) of the parameter matrices. Must be 16, 32, or 64. Defaults to 32. Rank = 64 is mainly useful if no exact re-ranking is performed in the query phase. </p></li>
<li><p><strong>train_size</strong> – Number of nearby clusters (<span class="math notranslate nohighlight">\(w\)</span>) used for training the reduced-rank regression models. Defaults to 5, but lower values can be used if <span class="math notranslate nohighlight">\(m \gtrsim 500 000\)</span> to speed up the index construction. </p></li>
<li><p><strong>distance</strong> – The distance measure to use. Either IP or L2. Defaults to IP. </p></li>
<li><p><strong>balanced</strong> – Whether to use balanced clustering. Defaults to false. </p></li>
<li><p><strong>copy</strong> – Whether to copy the input data. Defaults to false. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6Lorann6searchEPK1TKiKiKiPiP13lorann_dist_t">
<span id="_CPPv3NK6Lorann6Lorann6searchEPK1TKiKiKiPiP13lorann_dist_t"></span><span id="_CPPv2NK6Lorann6Lorann6searchEPK1TKiKiKiPiP13lorann_dist_t"></span><span id="Lorann::Lorann::search__TCP.iC.iC.iC.iP.lorann_dist_tPC"></span><span class="target" id="classLorann_1_1Lorann_1a59a66f99e001a0f742ba65505727dee2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">clusters_to_search</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">points_to_rerank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">idx_out</span></span>, <span class="n"><span class="pre">lorann_dist_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist_out</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6Lorann6searchEPK1TKiKiKiPiP13lorann_dist_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Query the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The query vector (dimensionality must match that of the index) </p></li>
<li><p><strong>k</strong> – The number of approximate nearest neighbors retrived </p></li>
<li><p><strong>clusters_to_search</strong> – Number of clusters to search </p></li>
<li><p><strong>points_to_rerank</strong> – Number of points for final (exact) re-ranking. If points_to_rerank is set to 0, no re-ranking is performed and the original data does not need to be kept in memory. In this case the final returned distances are approximate distances. </p></li>
<li><p><strong>idx_out</strong> – The index output array of length k </p></li>
<li><p><strong>dist_out</strong> – The (optional) distance output array of length k </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann6Lorann5buildEPK1TKiKbKbi">
<span id="_CPPv3N6Lorann6Lorann5buildEPK1TKiKbKbi"></span><span id="_CPPv2N6Lorann6Lorann5buildEPK1TKiKbKbi"></span><span id="Lorann::Lorann::build__TCP.iC.bC.bC.i"></span><span class="target" id="classLorann_1_1Lorann_1a7ea15460d09d4ea7b15546fce45ff53a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">query_data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">query_n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">approximate</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">verbose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Lorann6Lorann5buildEPK1TKiKbKbi" title="Link to this definition">#</a><br /></dt>
<dd><p>Build the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_data</strong> – An array of training queries of size <span class="math notranslate nohighlight">\(n \times d\)</span> used to build the index. Can be useful in the out-of-distribution setting where the training and query distributions differ. Ideally there should be at least as many training query points as there are index points. </p></li>
<li><p><strong>query_n</strong> – The number of training queries </p></li>
<li><p><strong>approximate</strong> – Whether to turn on various approximations during index construction. Defaults to true. Setting approximate to false slows down the index construction but can slightly increase the recall, especially if no exact re-ranking is used in the query phase. </p></li>
<li><p><strong>verbose</strong> – Whether to use verbose output for index construction. Defaults to false. </p></li>
<li><p><strong>num_threads</strong> – Number of CPU threads to use (set to -1 to use all cores) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6Lorann13get_n_samplesEv">
<span id="_CPPv3NK6Lorann6Lorann13get_n_samplesEv"></span><span id="_CPPv2NK6Lorann6Lorann13get_n_samplesEv"></span><span id="Lorann::Lorann::get_n_samplesC"></span><span class="target" id="classLorann_1_1LorannBase_1acd4973f3e4a947d513cfc231afc43414"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_n_samples</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6Lorann13get_n_samplesEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of samples in the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6Lorann7get_dimEv">
<span id="_CPPv3NK6Lorann6Lorann7get_dimEv"></span><span id="_CPPv2NK6Lorann6Lorann7get_dimEv"></span><span id="Lorann::Lorann::get_dimC"></span><span class="target" id="classLorann_1_1LorannBase_1a5c1d7bb6ad2db7f20adef133b30fec3a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6Lorann7get_dimEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the dimensionality of the vectors in the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6Lorann14get_n_clustersEv">
<span id="_CPPv3NK6Lorann6Lorann14get_n_clustersEv"></span><span id="_CPPv2NK6Lorann6Lorann14get_n_clustersEv"></span><span id="Lorann::Lorann::get_n_clustersC"></span><span class="target" id="classLorann_1_1LorannBase_1ad1fac990dafe75385e924c9c3ea11b2b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_n_clusters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6Lorann14get_n_clustersEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of clusters. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann6Lorann17get_dissimilarityEPK1TPK1T">
<span id="_CPPv3N6Lorann6Lorann17get_dissimilarityEPK1TPK1T"></span><span id="_CPPv2N6Lorann6Lorann17get_dissimilarityEPK1TPK1T"></span><span id="Lorann::Lorann::get_dissimilarity__TCP.TCP"></span><span class="target" id="classLorann_1_1LorannBase_1aeba0cd770aad9d2184a51cdfde524550"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">lorann_dist_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dissimilarity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">u</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann6Lorann17get_dissimilarityEPK1TPK1T" title="Link to this definition">#</a><br /></dt>
<dd><p>Compute the dissimilarity between two vectors. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – First vector </p></li>
<li><p><strong>v</strong> – Second vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float The dissimilarity </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann6Lorann5buildEKbKbi">
<span id="_CPPv3N6Lorann6Lorann5buildEKbKbi"></span><span id="_CPPv2N6Lorann6Lorann5buildEKbKbi"></span><span id="Lorann::Lorann::build__bC.bC.i"></span><span class="target" id="classLorann_1_1LorannBase_1a98b57396f92f172962e5597fcdf85712"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">approximate</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">verbose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann6Lorann5buildEKbKbi" title="Link to this definition">#</a><br /></dt>
<dd><p>Build the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>approximate</strong> – Whether to turn on various approximations during index construction. Defaults to true. Setting approximate to false slows down the index construction but can slightly increase the recall, especially if no exact re-ranking is used in the query phase. </p></li>
<li><p><strong>verbose</strong> – Whether to use verbose output for index construction. Defaults to false. </p></li>
<li><p><strong>num_threads</strong> – Number of CPU threads to use (set to -1 to use all cores) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6Lorann12exact_searchEPK1TiPiP13lorann_dist_t">
<span id="_CPPv3NK6Lorann6Lorann12exact_searchEPK1TiPiP13lorann_dist_t"></span><span id="_CPPv2NK6Lorann6Lorann12exact_searchEPK1TiPiP13lorann_dist_t"></span><span id="Lorann::Lorann::exact_search__TCP.i.iP.lorann_dist_tPC"></span><span class="target" id="classLorann_1_1LorannBase_1acf16a2ec7f25b4f067fb03f475c7028d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">exact_search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN6Lorann6LorannE" title="Lorann::Lorann::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">q</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out</span></span>, <span class="n"><span class="pre">lorann_dist_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist_out</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6Lorann12exact_searchEPK1TiPiP13lorann_dist_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Perform exact k-nn search using the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – The query vector (dimension must match the index data dimension) </p></li>
<li><p><strong>k</strong> – The number of nearest neighbors </p></li>
<li><p><strong>out</strong> – The index output array of length k </p></li>
<li><p><strong>dist_out</strong> – The (optional) distance output array of length k </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN6Lorann8LorannFPE">
<span id="_CPPv3I0EN6Lorann8LorannFPE"></span><span id="_CPPv2I0EN6Lorann8LorannFPE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classLorann_1_1LorannFP"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LorannFP</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">Lorann</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">LorannBase</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Lorann::LorannFP::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Link to this definition">#</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann8LorannFP8LorannFPEP1Tiiiiii8Distancebb">
<span id="_CPPv3N6Lorann8LorannFP8LorannFPEP1Tiiiiii8Distancebb"></span><span id="_CPPv2N6Lorann8LorannFP8LorannFPEP1Tiiiiii8Distancebb"></span><span id="Lorann::LorannFP::LorannFP__TP.i.i.i.i.i.i.Distance.b.b"></span><span class="target" id="classLorann_1_1LorannFP_1a9d28299204c9de2004365fcb18b7fe75"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LorannFP</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Lorann::LorannFP::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_clusters</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">global_dim</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rank</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">24</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">train_size</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5</span></span>, <span class="n"><span class="pre">Distance</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">distance</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">IP</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">balanced</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">copy</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann8LorannFP8LorannFPEP1Tiiiiii8Distancebb" title="Link to this definition">#</a><br /></dt>
<dd><p>Construct a new <a class="reference internal" href="#classLorann_1_1LorannFP"><span class="std std-ref">LorannFP</span></a> object. </p>
<p>NOTE: The constructor does not build the actual index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The data matrix as a T array of size <span class="math notranslate nohighlight">\(m \times d\)</span>, where T is either float, simsimd_f16_t, simsimd_bf16_t, uint8_t, or Lorann::BinaryType </p></li>
<li><p><strong>m</strong> – Number of points (rows) in the data matrix </p></li>
<li><p><strong>d</strong> – Number of dimensions (cols) in the data matrix </p></li>
<li><p><strong>n_clusters</strong> – Number of clusters. In general, for <span class="math notranslate nohighlight">\(m\)</span> index points, a good starting point is to set n_clusters as around <span class="math notranslate nohighlight">\(\sqrt{m}\)</span>. </p></li>
<li><p><strong>global_dim</strong> – Globally reduced dimension (<span class="math notranslate nohighlight">\(s\)</span>). Must be either -1 or an integer that is a multiple of 64. Higher values increase recall but also increase the query latency. In general, a good starting point is to set global_dim = -1 if <span class="math notranslate nohighlight">\(d &lt; 200\)</span>, global_dim = 128 if <span class="math notranslate nohighlight">\(200 \leq d \leq 1000\)</span>, and global_dim = 256 if <span class="math notranslate nohighlight">\(d &gt; 1000\)</span>. </p></li>
<li><p><strong>rank</strong> – Rank (<span class="math notranslate nohighlight">\(r\)</span>) of the parameter matrices. Defaults to 24. Higher ranks are mainly useful if no exact re-ranking is performed in the query phase. </p></li>
<li><p><strong>train_size</strong> – Number of nearby clusters (<span class="math notranslate nohighlight">\(w\)</span>) used for training the reduced-rank regression models. Defaults to 5, but lower values can be used if <span class="math notranslate nohighlight">\(m \gtrsim 500 000\)</span> to speed up the index construction. </p></li>
<li><p><strong>distance</strong> – The distance measure to use. Either IP or L2. Defaults to IP. </p></li>
<li><p><strong>balanced</strong> – Whether to use balanced clustering. Defaults to false. </p></li>
<li><p><strong>copy</strong> – Whether to copy the input data. Defaults to false. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann8LorannFP6searchEPK1TKiKiKiPiP13lorann_dist_t">
<span id="_CPPv3NK6Lorann8LorannFP6searchEPK1TKiKiKiPiP13lorann_dist_t"></span><span id="_CPPv2NK6Lorann8LorannFP6searchEPK1TKiKiKiPiP13lorann_dist_t"></span><span id="Lorann::LorannFP::search__TCP.iC.iC.iC.iP.lorann_dist_tPC"></span><span class="target" id="classLorann_1_1LorannFP_1aa13f240a84840beba123bc4527338c99"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Lorann::LorannFP::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">clusters_to_search</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">points_to_rerank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">idx_out</span></span>, <span class="n"><span class="pre">lorann_dist_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist_out</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4NK6Lorann8LorannFP6searchEPK1TKiKiKiPiP13lorann_dist_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Query the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The query vector (dimensionality must match that of the index) </p></li>
<li><p><strong>k</strong> – The number of approximate nearest neighbors retrived </p></li>
<li><p><strong>clusters_to_search</strong> – Number of clusters to search </p></li>
<li><p><strong>points_to_rerank</strong> – Number of points for final (exact) re-ranking. If points_to_rerank is set to 0, no re-ranking is performed and the original data does not need to be kept in memory. In this case the final returned distances are approximate distances. </p></li>
<li><p><strong>idx_out</strong> – The index output array of length k </p></li>
<li><p><strong>dist_out</strong> – The (optional) distance output array of length k </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann8LorannFP5buildEPK1TKiKbKbi">
<span id="_CPPv3N6Lorann8LorannFP5buildEPK1TKiKbKbi"></span><span id="_CPPv2N6Lorann8LorannFP5buildEPK1TKiKbKbi"></span><span id="Lorann::LorannFP::build__TCP.iC.bC.bC.i"></span><span class="target" id="classLorann_1_1LorannFP_1aa44c4be809f725de2538d6a9814faf62"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Lorann::LorannFP::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">query_data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">query_n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">approximate</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">verbose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Lorann8LorannFP5buildEPK1TKiKbKbi" title="Link to this definition">#</a><br /></dt>
<dd><p>Build the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_data</strong> – An array of training queries of size <span class="math notranslate nohighlight">\(n \times d\)</span> used to build the index. Can be useful in the out-of-distribution setting where the training and query distributions differ. Ideally there should be at least as many training query points as there are index points. </p></li>
<li><p><strong>query_n</strong> – The number of training queries </p></li>
<li><p><strong>approximate</strong> – Whether to turn on various approximations during index construction. Defaults to true. Setting approximate to false slows down the index construction but can slightly increase the recall, especially if no exact re-ranking is used in the query phase. </p></li>
<li><p><strong>verbose</strong> – Whether to use verbose output for index construction. Defaults to false. </p></li>
<li><p><strong>num_threads</strong> – Number of CPU threads to use (set to -1 to use all cores) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann8LorannFP13get_n_samplesEv">
<span id="_CPPv3NK6Lorann8LorannFP13get_n_samplesEv"></span><span id="_CPPv2NK6Lorann8LorannFP13get_n_samplesEv"></span><span id="Lorann::LorannFP::get_n_samplesC"></span><span class="target" id="classLorann_1_1LorannBase_1acd4973f3e4a947d513cfc231afc43414"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_n_samples</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann8LorannFP13get_n_samplesEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of samples in the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann8LorannFP7get_dimEv">
<span id="_CPPv3NK6Lorann8LorannFP7get_dimEv"></span><span id="_CPPv2NK6Lorann8LorannFP7get_dimEv"></span><span id="Lorann::LorannFP::get_dimC"></span><span class="target" id="classLorann_1_1LorannBase_1a5c1d7bb6ad2db7f20adef133b30fec3a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann8LorannFP7get_dimEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the dimensionality of the vectors in the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann8LorannFP14get_n_clustersEv">
<span id="_CPPv3NK6Lorann8LorannFP14get_n_clustersEv"></span><span id="_CPPv2NK6Lorann8LorannFP14get_n_clustersEv"></span><span id="Lorann::LorannFP::get_n_clustersC"></span><span class="target" id="classLorann_1_1LorannBase_1ad1fac990dafe75385e924c9c3ea11b2b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_n_clusters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann8LorannFP14get_n_clustersEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of clusters. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann8LorannFP17get_dissimilarityEPK1TPK1T">
<span id="_CPPv3N6Lorann8LorannFP17get_dissimilarityEPK1TPK1T"></span><span id="_CPPv2N6Lorann8LorannFP17get_dissimilarityEPK1TPK1T"></span><span id="Lorann::LorannFP::get_dissimilarity__TCP.TCP"></span><span class="target" id="classLorann_1_1LorannBase_1aeba0cd770aad9d2184a51cdfde524550"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">lorann_dist_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dissimilarity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Lorann::LorannFP::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">u</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Lorann::LorannFP::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann8LorannFP17get_dissimilarityEPK1TPK1T" title="Link to this definition">#</a><br /></dt>
<dd><p>Compute the dissimilarity between two vectors. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – First vector </p></li>
<li><p><strong>v</strong> – Second vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float The dissimilarity </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann8LorannFP5buildEKbKbi">
<span id="_CPPv3N6Lorann8LorannFP5buildEKbKbi"></span><span id="_CPPv2N6Lorann8LorannFP5buildEKbKbi"></span><span id="Lorann::LorannFP::build__bC.bC.i"></span><span class="target" id="classLorann_1_1LorannBase_1a98b57396f92f172962e5597fcdf85712"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">approximate</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">verbose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann8LorannFP5buildEKbKbi" title="Link to this definition">#</a><br /></dt>
<dd><p>Build the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>approximate</strong> – Whether to turn on various approximations during index construction. Defaults to true. Setting approximate to false slows down the index construction but can slightly increase the recall, especially if no exact re-ranking is used in the query phase. </p></li>
<li><p><strong>verbose</strong> – Whether to use verbose output for index construction. Defaults to false. </p></li>
<li><p><strong>num_threads</strong> – Number of CPU threads to use (set to -1 to use all cores) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann8LorannFP12exact_searchEPK1TiPiP13lorann_dist_t">
<span id="_CPPv3NK6Lorann8LorannFP12exact_searchEPK1TiPiP13lorann_dist_t"></span><span id="_CPPv2NK6Lorann8LorannFP12exact_searchEPK1TiPiP13lorann_dist_t"></span><span id="Lorann::LorannFP::exact_search__TCP.i.iP.lorann_dist_tPC"></span><span class="target" id="classLorann_1_1LorannBase_1acf16a2ec7f25b4f067fb03f475c7028d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">exact_search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN6Lorann8LorannFPE" title="Lorann::LorannFP::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">q</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out</span></span>, <span class="n"><span class="pre">lorann_dist_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist_out</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann8LorannFP12exact_searchEPK1TiPiP13lorann_dist_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Perform exact k-nn search using the index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – The query vector (dimension must match the index data dimension) </p></li>
<li><p><strong>k</strong> – The number of nearest neighbors </p></li>
<li><p><strong>out</strong> – The index output array of length k </p></li>
<li><p><strong>dist_out</strong> – The (optional) distance output array of length k </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann6KMeansE">
<span id="_CPPv3N6Lorann6KMeansE"></span><span id="_CPPv2N6Lorann6KMeansE"></span><span id="Lorann::KMeans"></span><span class="target" id="classLorann_1_1KMeans"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KMeans</span></span></span><a class="headerlink" href="#_CPPv4N6Lorann6KMeansE" title="Link to this definition">#</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann6KMeans6KMeansEiii8Distancebif">
<span id="_CPPv3N6Lorann6KMeans6KMeansEiii8Distancebif"></span><span id="_CPPv2N6Lorann6KMeans6KMeansEiii8Distancebif"></span><span id="Lorann::KMeans::KMeans__i.i.i.Distance.b.i.float"></span><span class="target" id="classLorann_1_1KMeans_1a75e3d9124096a78f3b9a6bad14af13d1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KMeans</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_clusters</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iters</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">25</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">samples_per_cluster</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">256</span></span>, <span class="n"><span class="pre">Distance</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">distance</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">IP</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">balanced</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_balance_diff</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">16</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">penalty_factor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.4</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann6KMeans6KMeansEiii8Distancebif" title="Link to this definition">#</a><br /></dt>
<dd><p>Construct a new <a class="reference internal" href="#classLorann_1_1KMeans"><span class="std std-ref">KMeans</span></a> object. </p>
<p>NOTE: The constructor does not perform the actual clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_clusters</strong> – The number of clusters (k) </p></li>
<li><p><strong>iters</strong> – The number of k-means iterations to perform. Defaults to 25. </p></li>
<li><p><strong>samples_per_cluster</strong> – Number of points to sample per cluster for k-means iterations (total sample size = samples_per_cluster * n_clusters). K-means iterations use this subset for speed, while final assignments use the full dataset. Set to &lt;= 0 to disable sampling. </p></li>
<li><p><strong>distance</strong> – The distance measure to use. Either IP or L2. Defaults to IP. </p></li>
<li><p><strong>balanced</strong> – Whether to ensure clusters are balanced using an efficient balanced k-means algorithm. Defaults to false. </p></li>
<li><p><strong>max_balance_diff</strong> – The maximum allowed difference in cluster sizes for balanced clustering. Used only if balanced = true. Defaults to 16. </p></li>
<li><p><strong>penalty_factor</strong> – Penalty factor for balanced clustering. Higher values can be used for faster clustering at the cost of clustering quality. Used only if balanced = True. Defaults to 1.4. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Lorann6KMeans5trainEPKfKiKiKbi">
<span id="_CPPv3N6Lorann6KMeans5trainEPKfKiKiKbi"></span><span id="_CPPv2N6Lorann6KMeans5trainEPKfKiKiKbi"></span><span id="Lorann::KMeans::train__floatCP.iC.iC.bC.i"></span><span class="target" id="classLorann_1_1KMeans_1a8de4acec6b62d49d3da13eaeb5de38db"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">train</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">verbose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Lorann6KMeans5trainEPKfKiKiKbi" title="Link to this definition">#</a><br /></dt>
<dd><p>Performs the clustering on the provided data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The data matrix </p></li>
<li><p><strong>n</strong> – Number of points (rows) in the data matrix </p></li>
<li><p><strong>m</strong> – Number of dimensions (cols) in the data matrix </p></li>
<li><p><strong>verbose</strong> – Whether to use verbose output. Defaults to false. </p></li>
<li><p><strong>num_threads</strong> – Number of CPU threads to use (set to -1 to use all cores) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>std::vector&lt;std::vector&lt;int&gt;&gt; Clustering assignments as a vector of vectors where each vector contains the ids of the points assigned to the corresponding cluster </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6KMeans6assignEPKfii">
<span id="_CPPv3NK6Lorann6KMeans6assignEPKfii"></span><span id="_CPPv2NK6Lorann6KMeans6assignEPKfii"></span><span id="Lorann::KMeans::assign__floatCP.i.iC"></span><span class="target" id="classLorann_1_1KMeans_1acb26ffef4d59edd03dca96be268d875c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assign</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6KMeans6assignEPKfii" title="Link to this definition">#</a><br /></dt>
<dd><p>Assign given data points to their k nearest clusters. </p>
<p>NOTE: The dimensionality of the data should match the dimensionality of the data that the clustering was trained on.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The data matrix </p></li>
<li><p><strong>n</strong> – The number of data points (rows) in the data matrix </p></li>
<li><p><strong>k</strong> – The number of clusters each point is assigned to </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>std::vector&lt;std::vector&lt;int&gt;&gt; Clustering assignments as a vector of vectors where each vector contains the ids of the points assigned to the corresponding cluster </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6KMeans14get_n_clustersEv">
<span id="_CPPv3NK6Lorann6KMeans14get_n_clustersEv"></span><span id="_CPPv2NK6Lorann6KMeans14get_n_clustersEv"></span><span id="Lorann::KMeans::get_n_clustersC"></span><span class="target" id="classLorann_1_1KMeans_1a438a6eae6f0e0ca1ec0e1f40a4cef44e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_n_clusters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6KMeans14get_n_clustersEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of clusters. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6KMeans9get_itersEv">
<span id="_CPPv3NK6Lorann6KMeans9get_itersEv"></span><span id="_CPPv2NK6Lorann6KMeans9get_itersEv"></span><span id="Lorann::KMeans::get_itersC"></span><span class="target" id="classLorann_1_1KMeans_1abd42b3b6770755a4304953a126a4e5ab"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_iters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6KMeans9get_itersEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of k-means iterations. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6KMeans11is_balancedEv">
<span id="_CPPv3NK6Lorann6KMeans11is_balancedEv"></span><span id="_CPPv2NK6Lorann6KMeans11is_balancedEv"></span><span id="Lorann::KMeans::is_balancedC"></span><span class="target" id="classLorann_1_1KMeans_1a8b12d53e013770a679290cdd52c19a3a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_balanced</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6KMeans11is_balancedEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get whether balanced k-means is used. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Lorann6KMeans13get_centroidsEv">
<span id="_CPPv3NK6Lorann6KMeans13get_centroidsEv"></span><span id="_CPPv2NK6Lorann6KMeans13get_centroidsEv"></span><span id="Lorann::KMeans::get_centroidsC"></span><span class="target" id="classLorann_1_1KMeans_1a37fefbe16d69666788cc2c19a7a3b4d1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">RowMatrix</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_centroids</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK6Lorann6KMeans13get_centroidsEv" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the centroids. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>float* Centroids as a float array of size n_clusters * dim </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">LoRANN documentation</p>
      </div>
    </a>
    <a class="right-next"
       href="python.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Python Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN6Lorann6LorannE"><code class="docutils literal notranslate"><span class="pre">Lorann::Lorann</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann6Lorann6LorannEP1Tiiiiii8Distancebb"><code class="docutils literal notranslate"><span class="pre">Lorann()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6Lorann6searchEPK1TKiKiKiPiP13lorann_dist_t"><code class="docutils literal notranslate"><span class="pre">search()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann6Lorann5buildEPK1TKiKbKbi"><code class="docutils literal notranslate"><span class="pre">build()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6Lorann13get_n_samplesEv"><code class="docutils literal notranslate"><span class="pre">get_n_samples()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6Lorann7get_dimEv"><code class="docutils literal notranslate"><span class="pre">get_dim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6Lorann14get_n_clustersEv"><code class="docutils literal notranslate"><span class="pre">get_n_clusters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann6Lorann17get_dissimilarityEPK1TPK1T"><code class="docutils literal notranslate"><span class="pre">get_dissimilarity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann6Lorann5buildEKbKbi"><code class="docutils literal notranslate"><span class="pre">build()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6Lorann12exact_searchEPK1TiPiP13lorann_dist_t"><code class="docutils literal notranslate"><span class="pre">exact_search()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0EN6Lorann8LorannFPE"><code class="docutils literal notranslate"><span class="pre">Lorann::LorannFP</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann8LorannFP8LorannFPEP1Tiiiiii8Distancebb"><code class="docutils literal notranslate"><span class="pre">LorannFP()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann8LorannFP6searchEPK1TKiKiKiPiP13lorann_dist_t"><code class="docutils literal notranslate"><span class="pre">search()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann8LorannFP5buildEPK1TKiKbKbi"><code class="docutils literal notranslate"><span class="pre">build()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann8LorannFP13get_n_samplesEv"><code class="docutils literal notranslate"><span class="pre">get_n_samples()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann8LorannFP7get_dimEv"><code class="docutils literal notranslate"><span class="pre">get_dim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann8LorannFP14get_n_clustersEv"><code class="docutils literal notranslate"><span class="pre">get_n_clusters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann8LorannFP17get_dissimilarityEPK1TPK1T"><code class="docutils literal notranslate"><span class="pre">get_dissimilarity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann8LorannFP5buildEKbKbi"><code class="docutils literal notranslate"><span class="pre">build()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann8LorannFP12exact_searchEPK1TiPiP13lorann_dist_t"><code class="docutils literal notranslate"><span class="pre">exact_search()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann6KMeansE"><code class="docutils literal notranslate"><span class="pre">Lorann::KMeans</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann6KMeans6KMeansEiii8Distancebif"><code class="docutils literal notranslate"><span class="pre">KMeans()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N6Lorann6KMeans5trainEPKfKiKiKbi"><code class="docutils literal notranslate"><span class="pre">train()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6KMeans6assignEPKfii"><code class="docutils literal notranslate"><span class="pre">assign()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6KMeans14get_n_clustersEv"><code class="docutils literal notranslate"><span class="pre">get_n_clusters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6KMeans9get_itersEv"><code class="docutils literal notranslate"><span class="pre">get_iters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6KMeans11is_balancedEv"><code class="docutils literal notranslate"><span class="pre">is_balanced()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NK6Lorann6KMeans13get_centroidsEv"><code class="docutils literal notranslate"><span class="pre">get_centroids()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cpp.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Elias Jääsaari.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>